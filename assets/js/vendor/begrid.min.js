"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t,e,i){"function"==typeof define&&define.amd?define("begrid",e):"object"==("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=e(i):t.BeGrid=e(i)}(window,function(l){function t(t){null==t||l(t).hasClass("be-grid-initialized")||(this.init(t),r.on("load",function(){this.ele.isotope("layout")}.bind(this)))}var r=l(window);return t.prototype.init=function(t){null!=t&&(this.ele=l(t),this.setDefaultProps(),this.setLayout(),this.setGutter(),this.initGridAnimation(),this.grid(),this.initEvents(),this.filterItems())},t.prototype.initEvents=function(){r.on("load",function(){this.ele.isotope("layout")}.bind(this)),r.on("resize",function(){var t=this.ele.find("audio, video"),e=this.ele.find(".be-slider");this.grid(),0<t.length&&t.each(function(){var t=l(this).data().mediaelementplayer;"object"==_typeof(t)&&(t.setPlayerSize(),t.setControlsSize())}),0<e.length&&(e.each(function(){var t=l(this);t.hasClass("flickity-enabled")&&t.flickity("reposition")}),this.ele.isotope("layout"))}.bind(this))},t.prototype.setDefaultProps=function(){this.cols=3,this.gutter=0,this.elementsToReveal=null,this.animationType="revealAllAtOnce",this.layout="masonry"},t.prototype.setGutter=function(){this.gutter=parseInt(this.ele.attr("data-gutter"))||0},t.prototype.setLayout=function(){"metro"===this.ele.attr("data-layout")?this.layout="metro":this.layout="masonry"},t.prototype.setCols=function(){var t=parseInt(this.ele.attr("data-cols"))||3,e=r.width();if(1024<e)this.cols=t;else if(959<e)switch(t){case 1:this.cols=1;break;case 2:this.cols=2;break;default:this.cols=3}else 767<e?this.cols=1==t?1:2:null!=this.ele.attr("data-mobile-cols")?this.cols=parseInt(this.ele.attr("data-mobile-cols")):this.cols=1},t.prototype.initGridAnimation=function(){this.animationType="true"===this.ele.attr("data-scroll-reveal")?"scrollReveal":"revealAllAtOnce",this.elementsToReveal=this.ele.find(".be-col"),this.addAnimationClass(),"scrollReveal"===this.animationType&&r.on("scroll",function(){this.triggerScrollReveal()}.bind(this))},t.prototype.addAnimationClass=function(){var t=this.ele.attr("data-animation-target")||".be-col",e=this.ele.attr("data-animation")||"be-col-hide";this.ele.find(t).addClass(e)},t.prototype.triggerScrollReveal=function(){var t;"scrollReveal"===this.animationType&&0<this.elementsToReveal.length&&0<(t=this.elementsToReveal.filter(function(){return l(this).isVisible(-100)})).length&&(t.each(function(t,e){var e=l(e),i=null==this.ele.attr("data-animation")?"be-col-visible":"be-start-animation",s=this.ele.attr("data-animation-target");(e=null!=s?e.find(s):e).css("transition-delay",150*t+"ms"),e.addClass(i)}.bind(this)),this.elementsToReveal=this.elementsToReveal.not(t))},t.prototype.filterItems=function(){"1"===this.ele.attr("data-filter-items")&&this.ele.parent().on("click",".sort-items",function(t){var e,i=l(t.currentTarget).data("id"),s=l([]);l(t.currentTarget).hasClass("current_choice")||(this.ele.parent().find(".sort-items").removeClass("current_choice"),l(t.currentTarget).addClass("current_choice"),(e=this.ele.find(".be-col")).css({transform:"scale(0)",transition:"all 0.3s ease"}),setTimeout(function(){e.find(".be-start-animation").css("transition-delay",""),e.css({transform:"",transition:""}),this.ele.isotope({filter:function(){var t=l(this).data("category-names");if("all"===i||-1<t.indexOf(i))return s=s.add(l(this)),!0},transitionDuration:0}),s.find(".be-start-animation").removeClass("be-start-animation"),this.elementsToReveal=s,setTimeout(function(){"scrollReveal"===this.animationType?this.triggerScrollReveal():this.revealAllAtOnce()}.bind(this),0)}.bind(this),300))}.bind(this))},t.prototype.revealAllAtOnce=function(){"revealAllAtOnce"===this.animationType&&0<this.elementsToReveal.length&&(this.elementsToReveal.each(function(t,e){var e=l(e),i=null==this.ele.attr("data-animation")?"be-col-visible":"be-start-animation",s=this.ele.attr("data-animation-target");(e=null!=s?e.find(s):e).css("transition-delay",150*t+"ms"),e.addClass(i)}.bind(this)),this.elementsToReveal=l([]))},t.prototype.grid=function(){this.setLayout(),this.setCols(),this.setWidth(),this.setGiantCells(),this.renderLayout()},t.prototype.setWidth=function(){this.ele.width("");for(var t,e=this.ele.width(),i=r.width(),s=this.ele.find(".be-col");e%this.cols!=0;)e=Math.round(e)+1;this.ele.width(e),t=e/this.cols,"masonry"!=this.layout&&767<i&&0<(i=s.filter(function(){return l(this).hasClass("be-double-width-cell")||l(this).hasClass("be-double-width-height-cell")})).length&&(s=s.not(i),i.outerWidth(2*t)),s.outerWidth(t)},t.prototype.setGiantCells=function(){var s,n,o,t,e,i,a;"metro"==this.layout&&(t=isNaN(parseFloat(this.ele.attr("data-aspect-ratio")))?1:parseFloat(this.ele.attr("data-aspect-ratio")),s=this.ele.width()/this.cols-this.gutter,n=r.width(),o=s/t,o=Math.round(100*o)/100,t=this.ele.find(".be-double-width-cell"),e=this.ele.find(".be-double-height-cell"),i=this.ele.find(".be-double-width-height-cell"),0<(a=this.ele.children().not(e).not(t).not(i)).length&&a.each(function(t,e){var e=l(e),i=o/s;isNaN(i)||(i*=100,e.find(".be-grid-placeholder").css("padding-bottom",i+"%"))}),0<t.length&&t.each(function(t,e){var e=l(e),i=767<n?o/(2*s+this.gutter):o/s;isNaN(i)||(i*=100,e.find(".be-grid-placeholder").css("padding-bottom",i+"%"))}.bind(this)),0<e.length&&e.each(function(t,e){var e=l(e),i=(2*o+this.gutter)/s;isNaN(i)||(i*=100,e.find(".be-grid-placeholder").css("padding-bottom",i+"%"))}.bind(this)),0<i.length)&&i.each(function(t,e){var e=l(e),i=767<n?(2*o+this.gutter)/(2*s+this.gutter):(2*o+this.gutter)/s;isNaN(i)||(i*=100,e.find(".be-grid-placeholder").css("padding-bottom",i+"%"))}.bind(this))},t.prototype.renderLayout=function(){var t=this.ele.width()/this.cols;this.ele.isotope({isInitLayout:!1,itemSelector:".be-col",resize:!1,masonry:{columnWidth:t}}),this.ele.on("layoutComplete",function(){this.ele.hasClass("be-grid-initialized")||(this.ele.addClass("be-grid-initialized"),setTimeout(function(){"scrollReveal"===this.animationType?this.triggerScrollReveal():this.revealAllAtOnce(),BeLazyLoad.lazyLoad()}.bind(this),0))}.bind(this)),this.ele.isotope()},t},jQuery);